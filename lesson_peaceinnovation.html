<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Peace Innovation - Lesson 2: Peace by Design | Juan José Vásquez-Pacheco</title>
  <meta name="description" content="Lesson 2: Peace by Design - Design thinking, participatory design, and innovation for sustainable peacebuilding." />
  <link rel="canonical" href="https://juapache.github.io/lesson_peaceinnovation.html" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Source+Serif+4:wght@500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="container nav-bar">
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="research.html">Research</a></li>
          <li><a href="teaching.html">Teaching</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="data-lab.html">Data Lab</a></li>
          <li><a href="blog.html">Blog</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <div class="lesson-header">
        <h1>Peace Innovation — Lesson 2: Peace by Design</h1>
        <p class="lesson-subtitle">Prerequisite: <a href="lesson_peaceinnovation-l1.html" style="color: inherit; text-decoration: underline;">Lesson 1: Intro to Peace Innovation</a></p>
        <p class="lesson-intro">In this lesson, we explore design thinking, participatory approaches, and practical frameworks for creating innovative solutions to peace challenges. We move from understanding the landscape (Lesson 1) to designing and prototyping solutions that are conflict-sensitive, sustainable, and community-led.</p>
      </div>

      <div class="lesson-progress">
        <div class="progress-tracker">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
        <span id="progress-text" class="progress-text">0% Complete</span>
      </div>

      <div class="lesson-modules">

        <!-- 1. Design Thinking for Peace Innovation -->
        <section id="m1" class="module-section" aria-labelledby="m1-title">
          <h2 id="m1-title">1. Design Thinking for Peace Innovation</h2>
          <p class="lead">A human-centered, iterative approach to solving complex peace challenges.</p>

          <details class="concept concept-alt-0" open>
            <summary><strong>Principles and Methodologies of Design Thinking</strong></summary>
            <p>Design thinking is a problem-solving approach emphasizing empathy, ideation, prototyping, and iteration. It centers the needs and perspectives of those most affected by a challenge, treating them as co-designers rather than passive recipients of solutions.</p>
          </details>

          <details class="concept concept-alt-1">
            <summary><strong>Applying Design Thinking to Peace Challenges</strong></summary>
            <p>Design thinking can address complex peace challenges: conflict resolution mechanisms, post-conflict reconstruction, social justice initiatives, and community healing. By iterating quickly with affected communities, innovators learn what works in specific contexts rather than importing standardized solutions.</p>
          </details>

          <details class="concept concept-alt-0">
            <summary><strong>Successful Examples of Design Thinking for Peace</strong></summary>
            <p>Case studies demonstrate how design thinking processes create sustainable peacebuilding outcomes. From dialogue platforms to economic initiatives to reconciliation programs, communities leading design processes generate solutions with deeper legitimacy and local ownership.</p>
          </details>

          <div class="resources-block">
            <h3>Additional Resources & Materials</h3>
            <p>Video lectures and materials coming soon. Placeholder for embedded videos and downloadable materials.</p>
            <div class="resource-placeholder">
              <p>Video 1 placeholder</p>
            </div>
            <div class="resource-placeholder">
              <p>Video 2 placeholder</p>
            </div>
          </div>

          <div class="notes-block">
            <label for="notes-m1" class="notes-label">Reflection — How might design thinking help you approach a peace challenge differently?</label>
            <textarea id="notes-m1" class="notes" rows="4" placeholder="Your notes (autosaved)"></textarea>
          </div>

          <div class="module-actions module-actions-centered">
            <button class="button-primary" data-complete="m1">Mark section complete</button>
            <div class="pager pager-right">
              <button class="button-quiet" data-next="#m2">Next →</button>
            </div>
          </div>
        </section>

        <!-- 2. Participatory Design and Co-creation -->
        <section id="m2" class="module-section" aria-labelledby="m2-title" hidden>
          <h2 id="m2-title">2. Participatory Design and Co-creation</h2>
          <p class="lead">Community leadership in designing peace solutions ensures legitimacy and sustainability.</p>

          <details class="concept concept-alt-0" open>
            <summary><strong>Participatory Design Methodologies</strong></summary>
            <p>Participatory design involves stakeholders and communities affected by conflict in all stages of the design process—from problem definition through prototyping and testing. This approach honors local knowledge, builds capacity, and creates solutions rooted in community priorities.</p>
          </details>

          <details class="concept concept-alt-1">
            <summary><strong>Empowering Local Communities</strong></summary>
            <p>True participation means communities have decision-making power, not just input. Empowered communities own peacebuilding initiatives, make choices aligned with their values, and drive sustainability. This contrasts with tokenistic participation where communities are consulted but decisions are made by outsiders.</p>
          </details>

          <details class="concept concept-alt-0">
            <summary><strong>Case Studies in Participatory Design</strong></summary>
            <p>Examples from inclusive governance structures, community development initiatives, and reconciliation processes show how participatory design creates stronger outcomes. Communities address governance through co-designed institutions, develop livelihoods that reflect local priorities, and design reconciliation processes that heal trauma while building justice.</p>
          </details>

          <div class="resources-block">
            <h3>Additional Resources & Materials</h3>
            <p>Video lectures and materials coming soon. Placeholder for embedded videos and downloadable materials.</p>
            <div class="resource-placeholder">
              <p>Video 1 placeholder</p>
            </div>
            <div class="resource-placeholder">
              <p>Video 2 placeholder</p>
            </div>
          </div>

          <div class="quiz-block" aria-labelledby="quiz-title-m2">
            <h3 id="quiz-title-m2">Quick Check</h3>
            <form id="quiz-m2" class="quiz" aria-describedby="quiz-desc-m2">
              <p id="quiz-desc-m2" class="muted">3 questions to reinforce core concepts.</p>

              <fieldset>
                <legend>1) Participatory design differs from traditional design by…</legend>
                <label><input type="radio" name="q1m2" value="a"> focusing on cost reduction</label>
                <label><input type="radio" name="q1m2" value="b"> involving affected communities in decision-making, not just consultation</label>
                <label><input type="radio" name="q1m2" value="c"> prioritizing speed over quality</label>
              </fieldset>

              <fieldset>
                <legend>2) Co-creation with affected communities ensures…</legend>
                <label><input type="radio" name="q2m2" value="a"> external control of outcomes</label>
                <label><input type="radio" name="q2m2" value="b"> ownership, legitimacy, and sustainability of solutions</label>
                <label><input type="radio" name="q2m2" value="c"> faster implementation</label>
              </fieldset>

              <fieldset>
                <legend>3) Empowering local ownership leads to…</legend>
                <label><input type="radio" name="q3m2" value="a"> dependency on external support</label>
                <label><input type="radio" name="q3m2" value="b"> reduced local capacity</label>
                <label><input type="radio" name="q3m2" value="c"> sustainable peacebuilding driven by community agency</label>
              </fieldset>

              <div class="quiz-actions">
                <button type="button" id="check-quiz-m2" class="button-primary">Check answers</button>
                <button type="button" id="try-quiz-m2" class="button-secondary">Try again</button>
                <span id="quiz-result-m2" role="status" aria-live="polite"></span>
              </div>
            </form>
          </div>

          <div class="notes-block">
            <label for="notes-m2" class="notes-label">Reflection — How can you ensure genuine participation rather than tokenism in your peace work?</label>
            <textarea id="notes-m2" class="notes" rows="4" placeholder="Your notes (autosaved)"></textarea>
          </div>

          <div class="module-actions module-actions-centered">
            <button class="button-quiet" data-prev="#m1">← Previous</button>
            <button class="button-primary" data-complete="m2">Mark section complete</button>
            <div class="pager pager-right">
              <button class="button-quiet" data-next="#m3">Next →</button>
            </div>
          </div>
        </section>

        <!-- 3. Designing for Social Impact and Sustainability -->
        <section id="m3" class="module-section" aria-labelledby="m3-title" hidden>
          <h2 id="m3-title">3. Designing for Social Impact and Sustainability</h2>
          <p class="lead">Creating peace innovations that address multiple dimensions and endure over time.</p>

          <details class="concept concept-alt-0" open>
            <summary><strong>Design for Social Impact in Peacebuilding</strong></summary>
            <p>Social impact design focuses on creating sustained positive change. In peacebuilding, this means innovations that reduce violence, build relationships, strengthen institutions, and enable human flourishing. Impact thinking requires understanding how change happens and measuring progress toward peace outcomes.</p>
          </details>

          <details class="concept concept-alt-1">
            <summary><strong>Addressing Environmental, Economic, and Social Dimensions</strong></summary>
            <p>Sustainable peace requires addressing multiple dimensions simultaneously. Environmental degradation and resource scarcity fuel conflict; economic inequality creates grievances; social exclusion prevents healing. Effective peace innovations integrate environmental sustainability, economic justice, and inclusive social systems.</p>
          </details>

          <details class="concept concept-alt-0">
            <summary><strong>Long-term Sustainability and Inclusivity</strong></summary>
            <p>Innovations that fade when external funding ends have limited impact. Sustainable designs build local capacity, integrate with existing systems, create revenue streams where possible, and ensure inclusion of marginalized voices. Sustainability thinking starts in the design phase, not as an afterthought.</p>
          </details>

          <div class="resources-block">
            <h3>Additional Resources & Materials</h3>
            <p>Video lectures and materials coming soon. Placeholder for embedded videos and downloadable materials.</p>
            <div class="resource-placeholder">
              <p>Video 1 placeholder</p>
            </div>
            <div class="resource-placeholder">
              <p>Video 2 placeholder</p>
            </div>
          </div>

          <div class="notes-block">
            <label for="notes-m3" class="notes-label">Reflection — What does sustainable peace look like in a context you care about?</label>
            <textarea id="notes-m3" class="notes" rows="4" placeholder="Your notes (autosaved)"></textarea>
          </div>

          <div class="module-actions module-actions-centered">
            <button class="button-quiet" data-prev="#m2">← Previous</button>
            <button class="button-primary" data-complete="m3">Mark section complete</button>
            <div class="pager pager-right">
              <button class="button-quiet" data-next="#m4">Next →</button>
            </div>
          </div>
        </section>

        <!-- 4. Designing for Conflict Transformation and Reconciliation -->
        <section id="m4" class="module-section" aria-labelledby="m4-title" hidden>
          <h2 id="m4-title">4. Designing for Conflict Transformation and Reconciliation</h2>
          <p class="lead">Using design to support healing, dialogue, and restoration of relationships.</p>

          <details class="concept concept-alt-0" open>
            <summary><strong>Design for Healing and Dialogue</strong></summary>
            <p>Design can intentionally create spaces and processes for healing individual and collective trauma. Dialogue processes, truth-telling ceremonies, and restorative justice mechanisms can be designed with attention to trauma-informed practice, cultural appropriateness, and psychological safety.</p>
          </details>

          <details class="concept concept-alt-1">
            <summary><strong>Bridging Divides Through Design</strong></summary>
            <p>Projects that bridge historical divides—from joint cultural events to economic ventures to joint problem-solving initiatives—require thoughtful design. These initiatives must create genuine contact across divides, challenge stereotypes, and build relationships while being sensitive to power imbalances and ongoing grievances.</p>
          </details>

          <details class="concept concept-alt-0">
            <summary><strong>Memorialization and Cultural Heritage</strong></summary>
            <p>Public spaces, memorials, and cultural heritage preservation can support peacebuilding. Thoughtfully designed memorials honor victims while pointing toward reconciliation. Public spaces redesigned with input from all communities can symbolize shared ownership and renewed coexistence. Cultural heritage protection preserves identity while fostering cross-community understanding.</p>
          </details>

          <div class="resources-block">
            <h3>Additional Resources & Materials</h3>
            <p>Video lectures and materials coming soon. Placeholder for embedded videos and downloadable materials.</p>
            <div class="resource-placeholder">
              <p>Video 1 placeholder</p>
            </div>
            <div class="resource-placeholder">
              <p>Video 2 placeholder</p>
            </div>
          </div>

          <div class="quiz-block" aria-labelledby="quiz-title-m4">
            <h3 id="quiz-title-m4">Quick Check</h3>
            <form id="quiz-m4" class="quiz" aria-describedby="quiz-desc-m4">
              <p id="quiz-desc-m4" class="muted">3 questions to reinforce core concepts.</p>

              <fieldset>
                <legend>1) Design for reconciliation focuses on…</legend>
                <label><input type="radio" name="q1m4" value="a"> punishment of perpetrators</label>
                <label><input type="radio" name="q1m4" value="b"> healing relationships and restoring dignity</label>
                <label><input type="radio" name="q1m4" value="c"> forgetting the past</label>
              </fieldset>

              <fieldset>
                <legend>2) Memorialization projects can support peace by…</legend>
                <label><input type="radio" name="q2m4" value="a"> glorifying violence</label>
                <label><input type="radio" name="q2m4" value="b"> honoring victims while pointing toward reconciliation and coexistence</label>
                <label><input type="radio" name="q2m4" value="c"> erasing historical memory</label>
              </fieldset>

              <fieldset>
                <legend>3) Bridging divides requires design that…</legend>
                <label><input type="radio" name="q3m4" value="a"> minimizes contact between groups</label>
                <label><input type="radio" name="q3m4" value="b"> creates genuine contact, challenges stereotypes, and builds relationships across difference</label>
                <label><input type="radio" name="q3m4" value="c"> ignores power imbalances</label>
              </fieldset>

              <div class="quiz-actions">
                <button type="button" id="check-quiz-m4" class="button-primary">Check answers</button>
                <button type="button" id="try-quiz-m4" class="button-secondary">Try again</button>
                <span id="quiz-result-m4" role="status" aria-live="polite"></span>
              </div>
            </form>
          </div>

          <div class="notes-block">
            <label for="notes-m4" class="notes-label">Reflection — How can design facilitate healing between communities in conflict?</label>
            <textarea id="notes-m4" class="notes" rows="4" placeholder="Your notes (autosaved)"></textarea>
          </div>

          <div class="module-actions module-actions-centered">
            <button class="button-quiet" data-prev="#m3">← Previous</button>
            <button class="button-primary" data-complete="m4">Mark section complete</button>
            <div class="pager pager-right">
              <button class="button-quiet" data-next="#m5">Next →</button>
            </div>
          </div>
        </section>

        <!-- 5. Communication Design, Ethics, and Impact Measurement -->
        <section id="m5" class="module-section" aria-labelledby="m5-title" hidden>
          <h2 id="m5-title">5. Communication Design, Ethics, and Impact Measurement</h2>
          <p class="lead">Designing for narrative change, ethical practice, and accountability.</p>

          <details class="concept concept-alt-0" open>
            <summary><strong>Communication Design for Peacebuilding</strong></summary>
            <p>Communication design uses visual communication, storytelling, media campaigns, and public messaging to shift narratives about conflict. Effective peace communication challenges stereotypes, promotes cultural sensitivity, humanizes "the other," and counters divisive narratives that fuel conflict.</p>
          </details>

          <details class="concept concept-alt-1">
            <summary><strong>Design Ethics and Responsible Innovation</strong></summary>
            <p>Peace innovations carry ethical weight. Responsible design requires considering: Who might be harmed? Who benefits and who is excluded? What unintended consequences might arise? Ethical frameworks grounded in human rights, do-no-harm principles, and inclusive design guide moral choices throughout the innovation process.</p>
          </details>

          <details class="concept concept-alt-0">
            <summary><strong>Design Evaluation and Impact Measurement</strong></summary>
            <p>Measuring design impact requires methodologies that capture both quantitative metrics (reduced violence, increased dialogue, economic gains) and qualitative indicators (trust, agency, dignity). Evaluation should be participatory—affected communities help define success and assess progress toward peace outcomes.</p>
          </details>

          <div class="resources-block">
            <h3>Additional Resources & Materials</h3>
            <p>Video lectures and materials coming soon. Placeholder for embedded videos and downloadable materials.</p>
            <div class="resource-placeholder">
              <p>Video 1 placeholder</p>
            </div>
            <div class="resource-placeholder">
              <p>Video 2 placeholder</p>
            </div>
          </div>

          <div class="quiz-block" aria-labelledby="quiz-title-final">
            <h3 id="quiz-title-final">Final Comprehensive Quiz</h3>
            <form id="quiz-final" class="quiz" aria-describedby="quiz-desc-final">
              <p id="quiz-desc-final" class="muted">6 questions evaluating concepts from the entire lesson.</p>

              <fieldset>
                <legend>1) Design thinking for peace emphasizes…</legend>
                <label><input type="radio" name="qf1" value="a"> expert-driven solutions</label>
                <label><input type="radio" name="qf1" value="b"> community leadership, iteration, and human-centered problem-solving</label>
                <label><input type="radio" name="qf1" value="c"> avoiding community input</label>
              </fieldset>

              <fieldset>
                <legend>2) Participatory design benefits peacebuilding by…</legend>
                <label><input type="radio" name="qf2" value="a"> slowing down implementation</label>
                <label><input type="radio" name="qf2" value="b"> creating legitimacy, ownership, and sustainability through community leadership</label>
                <label><input type="radio" name="qf2" value="c"> reducing cost</label>
              </fieldset>

              <fieldset>
                <legend>3) Sustainable peace design must address…</legend>
                <label><input type="radio" name="qf3" value="a"> only economic dimensions</label>
                <label><input type="radio" name="qf3" value="b"> environmental, economic, and social dimensions simultaneously</label>
                <label><input type="radio" name="qf3" value="c"> only security concerns</label>
              </fieldset>

              <fieldset>
                <legend>4) Reconciliation through design focuses on…</legend>
                <label><input type="radio" name="qf4" value="a"> ignoring historical harm</label>
                <label><input type="radio" name="qf4" value="b"> healing relationships, restoring dignity, and building shared futures</label>
                <label><input type="radio" name="qf4" value="c"> maintaining separation between groups</label>
              </fieldset>

              <fieldset>
                <legend>5) Communication design for peace should…</legend>
                <label><input type="radio" name="qf5" value="a"> amplify divisive narratives</label>
                <label><input type="radio" name="qf5" value="b"> challenge stereotypes and promote understanding across divides</label>
                <label><input type="radio" name="qf5" value="c"> avoid controversial topics</label>
              </fieldset>

              <fieldset>
                <legend>6) Measuring design impact requires…</legend>
                <label><input type="radio" name="qf6" value="a"> only counting violence statistics</label>
                <label><input type="radio" name="qf6" value="b"> participatory evaluation capturing both quantitative and qualitative peace indicators</label>
                <label><input type="radio" name="qf6" value="c"> external evaluators only</label>
              </fieldset>

              <div class="quiz-actions">
                <button type="button" id="check-quiz-final" class="button-primary">Check answers</button>
                <button type="button" id="try-quiz-final" class="button-secondary">Try again</button>
                <span id="quiz-result-final" role="status" aria-live="polite"></span>
              </div>
            </form>
          </div>

          <div class="notes-block">
            <label for="notes-m5" class="notes-label">Final Reflection — Choose one design approach from this lesson (design thinking, participatory design, communication design, etc.) and describe how you would apply it to a peace challenge in your community or a context you care about.</label>
            <textarea id="notes-m5" class="notes" rows="6" placeholder="Your final reflection (autosaved)"></textarea>
          </div>

          <div class="module-actions module-actions-centered">
            <button class="button-quiet" data-prev="#m4">← Previous</button>
            <button class="button-primary" data-complete="m5">Mark section complete</button>
          </div>

          <div class="restart-section">
            <button class="button-secondary" id="restart-lesson">↻ Restart Lesson</button>
          </div>
        </section>

      </div>

    </div>
  </main>

  <footer>
    <div class="container footer">
      <p>&copy; 2026 Juan José Vásquez-Pacheco.</p>
      <a class="deep-link" href="teaching.html">← Back to Teaching →</a>
    </div>
  </footer>

  <script>
    // Progress tracking
    const module_keys = ['m1', 'm2', 'm3', 'm4', 'm5'];
    const storage_key = 'lesson2_progress';
    const storage_notes_key = 'lesson2_notes';

    // Load progress
    function load_progress() {
      const stored = localStorage.getItem(storage_key);
      return stored ? JSON.parse(stored) : {};
    }

    function save_progress(progress) {
      localStorage.setItem(storage_key, JSON.stringify(progress));
      update_progress_display();
    }

    function update_progress_display() {
      const progress = load_progress();
      const completed = Object.values(progress).filter(v => v).length;
      const total = module_keys.length;
      const percent = Math.round((completed / total) * 100);
      
      document.getElementById('progress-bar').style.width = percent + '%';
      document.getElementById('progress-text').textContent = percent + '% Complete';
    }

    // Module navigation
    document.querySelectorAll('[data-complete]').forEach(btn => {
      btn.addEventListener('click', function() {
        const module = this.getAttribute('data-complete');
        const progress = load_progress();
        progress[module] = true;
        save_progress(progress);
        alert('Section marked complete! Great work.');
      });
    });

    document.querySelectorAll('[data-next]').forEach(btn => {
      btn.addEventListener('click', function() {
        const target = this.getAttribute('data-next');
        document.querySelectorAll('.module-section').forEach(s => s.hidden = true);
        document.querySelector(target).hidden = false;
        window.scrollTo(0, 0);
      });
    });

    document.querySelectorAll('[data-prev]').forEach(btn => {
      btn.addEventListener('click', function() {
        const target = this.getAttribute('data-prev');
        document.querySelectorAll('.module-section').forEach(s => s.hidden = true);
        document.querySelector(target).hidden = false;
        window.scrollTo(0, 0);
      });
    });

    // Quiz checking
    function check_quiz(form_id, quiz_name) {
      const form = document.getElementById(form_id);
      const answers = {};
      
      form.querySelectorAll('fieldset').forEach(fs => {
        const checked = fs.querySelector('input:checked');
        if (checked) {
          const legend = fs.querySelector('legend').textContent;
          answers[legend] = checked.value;
        }
      });

      const answer_key = {
        '1) Design thinking for peace emphasizes…': 'b',
        '2) Participatory design benefits peacebuilding by…': 'b',
        '3) Sustainable peace design must address…': 'b',
        '4) Reconciliation through design focuses on…': 'b',
        '5) Communication design for peace should…': 'b',
        '6) Measuring design impact requires…': 'b'
      };

      const m2_key = {
        '1) Participatory design differs from traditional design by…': 'b',
        '2) Co-creation with affected communities ensures…': 'b',
        '3) Empowering local ownership leads to…': 'c'
      };

      const m4_key = {
        '1) Design for reconciliation focuses on…': 'b',
        '2) Memorialization projects can support peace by…': 'b',
        '3) Bridging divides requires design that…': 'b'
      };

      let key = answer_key;
      if (quiz_name === 'm2') key = m2_key;
      if (quiz_name === 'm4') key = m4_key;

      let correct = 0;
      Object.entries(answers).forEach(([q, a]) => {
        if (key[q] === a) correct++;
      });

      const total = Object.keys(key).length;
      const percent = Math.round((correct / total) * 100);
      const msg = percent >= 70 ? '✓ Great work!' : 'Review and try again.';
      
      document.getElementById(`quiz-result-${quiz_name}`).textContent = `${correct}/${total} correct (${percent}%) ${msg}`;
    }

    document.getElementById('check-quiz-m2').addEventListener('click', () => check_quiz('quiz-m2', 'm2'));
    document.getElementById('check-quiz-m4').addEventListener('click', () => check_quiz('quiz-m4', 'm4'));
    document.getElementById('check-quiz-final').addEventListener('click', () => check_quiz('quiz-final', 'final'));

    document.getElementById('try-quiz-m2').addEventListener('click', () => {
      document.getElementById('quiz-m2').reset();
      document.getElementById('quiz-result-m2').textContent = '';
    });

    document.getElementById('try-quiz-m4').addEventListener('click', () => {
      document.getElementById('quiz-m4').reset();
      document.getElementById('quiz-result-m4').textContent = '';
    });

    document.getElementById('try-quiz-final').addEventListener('click', () => {
      document.getElementById('quiz-final').reset();
      document.getElementById('quiz-result-final').textContent = '';
    });

    // Autosave notes
    const textarea_elements = document.querySelectorAll('textarea.notes');
    textarea_elements.forEach(ta => {
      const id = ta.id;
      const saved = localStorage.getItem(storage_notes_key + '_' + id);
      if (saved) ta.value = saved;

      ta.addEventListener('change', () => {
        localStorage.setItem(storage_notes_key + '_' + id, ta.value);
      });
    });

    // Restart lesson
    document.getElementById('restart-lesson').addEventListener('click', () => {
      if (confirm('Are you sure? This will reset all progress and notes.')) {
        localStorage.removeItem(storage_key);
        textarea_elements.forEach(ta => {
          localStorage.removeItem(storage_notes_key + '_' + ta.id);
          ta.value = '';
        });
        document.querySelectorAll('.module-section').forEach(s => s.hidden = true);
        document.getElementById('m1').hidden = false;
        update_progress_display();
        window.scrollTo(0, 0);
      }
    });

    // Initialize
    update_progress_display();
  </script>
</body>
</html>
